<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;1.&nbsp;OpenStack API Quick Start</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Chapter&nbsp;1.&nbsp;OpenStack API Quick Start"><link rel="next" href="ch01s02.html" title="Sending Requests to the API"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;1.&nbsp;OpenStack API Quick Start</th></tr><tr><td width="20%" align="left">&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s02.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;1.&nbsp;OpenStack API Quick Start"><div class="titlepage"><div><div><h2 class="title"><a name="Compute_API_Quick_Start"></a>Chapter&nbsp;1.&nbsp;OpenStack API Quick Start</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="index.html#Getting-Credentials-a00665">Authentication</a></span></dt><dt><span class="section"><a href="ch01s02.html">Sending Requests to the API</a></span></dt></dl></div><p>The OpenStack system has several key projects that are separate installations but can work
        together depending on your cloud needs: OpenStack Compute, OpenStack Object Storage,
        OpenStack Identity Service, and OpenStack Image Service. </p><p>This page covers the basics for working with your OpenStack cloud through the Compute API and Image API
            after authorizing with the Identity Service API. You can then build a cloud by launching
            images and assigning metadata to instances, all through the API. </p><div class="section" title="Authentication"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Getting-Credentials-a00665"></a>Authentication</h2></div></div></div><p>Credentials are a combination of your username, password, and what tenant (or project) your
            cloud is running under. You only need to generate an additional token if you are
            interacting with your cloud directly with API endpoints, and not with a client. Your
            cloud administrator can give you a username and a password as well as your tenant
            identifier so you can generate authorization tokens. These tokens are typically good for
            24 hours, and when the token expires, you will find out with a 401 (Unauthorized) error
            and can request another token programmatically. The general workflow goes something like
            this: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Begin API requests by asking for a token from the endpoint your cloud
                    administrator gave you, typically http://hostname:5000/v2.0/tokens. You send your
                    username, password, and what group you are with (which "tenant" in auth-speak). </p><pre class="programlisting">
$ curl -X 'POST' -v http://host.na.me:5000/v2.0/tokens -d '{"auth":{"passwordCredentials":{"username": "joecool", "password":"coolword"}, "tenantId":"5"}}' -H 'Content-type: application/json' 
        </pre></li><li class="listitem"><p>The server returns a response in which the 24-hours token is contained :
                    </p><pre class="programlisting">
* About to connect() to host.na.me port 5000 (#0)
*   Trying 55.51.11.198... connected
* Connected to host.na.me (55.51.11.198) port 5000 (#0)
&gt; POST /v2.0/tokens HTTP/1.1
&gt; User-Agent: curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8r zlib/1.2.3
&gt; Host: host.na.me:5000v&gt; Accept: */*
&gt; Content-type: application/json
&gt; Content-Length: 95
&gt; 
&gt; HTTP/1.1 200 OK
&gt; Content-Type: application/json; charset=UTF-8
&gt; Content-Length: 935
&gt; Date: Thu, 06 Oct 2011 19:59:49 GMT
&gt; 
* Connection #0 to host host.na.me left intact
* Closing connection #0
{"access": {"token": {"expires": "2011-10-07T14:59:49.644963", 
"id": "e83abbdc-a8c8-4f81-897b-541cbcd1dbb5", 
"tenant": {"id": "5", "name": "coolu"}}, "serviceCatalog": 
[{"endpoints": [{"adminURL": "http://55.51.11.198:8774/v1.1/5", 
"region": "RegionOne", "internalURL": "http://55.51.11.198:8774/v1.1/5", 
"publicURL": "http://55.51.11.198:8774/v1.1/5"}], "type": "compute", "name": "nova"}, 
{"endpoints": [{"adminURL": "http://55.51.11.198:9292/v1.1/5", 
"region": "RegionOne", "internalURL": "http://55.51.11.198:9292/v1.1/5", 
"publicURL": "http://55.51.11.198:9292/v1.1/5"}], "type": "image", "name": "glance"}, 
{"endpoints": [{"adminURL": "http://55.51.11.198:35357/v2.0", 
"region": "RegionOne", "internalURL": "http://55.51.11.198:5000/v2.0", 
"publicURL": "http://55.51.11.198:5000/v2.0"}], 
"type": "identity", "name": "keystone"}], "user": {"id": "4", "roles": 
[{"tenantId": "5", "id": "2", "name": "Member"}], "name": "joecool"}}}

 </pre><p>
                    Use that token to send API requests with the X-Auth-Token included as an header
                    field.</p></li><li class="listitem"><p>Repeatedly send API requests with that token in the x-auth-token header until
                    either: 1) the job's done or 2) you get a 401 (Unauthorized) code in return.
                </p></li><li class="listitem"><p>Request a token again when you get a 401 response until the script's job is
                    done.</p></li></ol></div><p>For a typical OpenStack deployment running the Identity Service you can request a token
            with this command in
            cURL:</p><pre class="programlisting">
$ curl -X 'POST' -v http://host.na.me:5000/v2.0/tokens -d '{"auth":{"passwordCredentials":{"username": "joecool", "password":"coolword"}, "tenantId":"5"}}' -H 'Content-type: application/json' 
         </pre><p>In return, you should get a 200 OK response with a token in the form of "id": "cd427a33-bb4a-4079-a6d7-0ae148bdeda9" and an expiration date 24 hours from now. Here's what it looks like:</p><p>
    </p><pre class="programlisting">
* About to connect() to host.na.me port 5000 (#0)
*   Trying hostname... connected
* Connected to host.na.me (hostname) port 5000 (#0)
&gt; POST /v2.0/tokens HTTP/1.1
&gt; User-Agent: curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8r zlib/1.2.3
&gt; Host: host.na.me:5000
&gt; Accept: */*
&gt; Content-type: application/json
&gt; Content-Length: 85
&gt; 
&gt; HTTP/1.1 200 OK
&gt; Content-Type: application/json; charset=UTF-8
&gt; Content-Length: 1213
&gt; Date: Thu, 01 Sep 2011 19:27:30 GMT
&gt; 
* Connection #0 to host host.na.me left intact
* Closing connection #0
{"access": {"token": {"expires": "2011-10-07T14:59:49.644963", 
"id": "e83abbdc-a8c8-4f81-897b-541cbcd1dbb5", 
"tenant": {"id": "5", "name": "coolu"}}, 
"serviceCatalog": 
[{"endpoints": [{"adminURL": "http://55.51.11.198:8774/v1.1/5", 
"region": "RegionOne", "internalURL": "http://55.51.11.198:8774/v1.1/5", 
"publicURL": "http://55.51.11.198:8774/v1.1/5"}], 
"type": "compute", "name": "nova"}, 
{"endpoints": [{"adminURL": "http://55.51.11.198:9292/v1.1/5",
 "region": "RegionOne", "internalURL": "http://55.51.11.198:9292/v1.1/5", 
"publicURL": "http://55.51.11.198:9292/v1.1/5"}], "type": "image", "name": "glance"}, 
{"endpoints": [{"adminURL": "http://55.51.11.198:35357/v2.0", 
"region": "RegionOne", "internalURL": "http://55.51.11.198:5000/v2.0", 
"publicURL": "http://55.51.11.198:5000/v2.0"}], 
"type": "identity", "name": "keystone"}], 
"user": {"id": "4", "roles": [{"tenantId": "5", "id": "2", "name": "Member"}], "name": "joecool"}}}
    </pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left">&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right" valign="top">&nbsp;Sending Requests to the API</td></tr></table></div></body></html>