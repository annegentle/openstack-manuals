<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="install-glance"
    xmlns="http://docbook.org/ns/docbook"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
    <title>Installing and Configuring the Image Service</title>
    
    <para>Install the Image service:</para>
    <literallayout class="monospaced">sudo apt-get install glance</literallayout>
 <section xml:id="configure-glance"><title>Configuring the Image Service</title>
    <para>Configure the backend data store. For MySQL, create a
        glance MySQL database and a glance MySQL user. Grant the
        "glance" user full access to the glance MySQL
        database.</para>
    <para>Start the mysql command line client by running:</para>
    <para><literallayout class="monospaced">mysql -u root -p</literallayout></para>
    <para>Enter the mysql root user's password when prompted.</para>
    <para>To configure the MySQL database, create the glance database. </para>
    <para><literallayout class="monospaced">mysql> CREATE DATABASE glance;</literallayout></para>
    <para>Create a MySQL user for the newly-created glance database that
        has full control of the database. </para>
    <para><literallayout class="monospaced">mysql> GRANT ALL ON glance.* TO 'glance'@'%' IDENTIFIED BY 'yourpassword';</literallayout></para>
    <para>Enter quit at the mysql> prompt to exit MySQL.</para>
    <para><literallayout class="monospaced">mysql> quit</literallayout></para>
    <para>Edit /etc/glance/glance-registry.conf to include the
        sql_connection to use the backend data store in mysql,
        such as mysql://glance:yourpassword@192.168.206.130/glance.
        Here is the relevant section:</para>
    <para>
        <literallayout class="monospaced"># SQLAlchemy connection string for the reference implementation 
# registry server. Any valid SQLAlchemy connection string is fine. 
# See: http://www.sqlalchemy.org/docs/05/reference/sqlalchemy/connections.html#sqlalchemy.create_engine 
sql_connection = mysql://glance:yourpassword@192.168.206.130/glance</literallayout>
    </para>
        <para>Edit /etc/glance/glance-scrubber.conf to include the
            sql_connection information also, in the same format as the
            example above.</para>
        <para>Edit /etc/glance/glance-api.conf to update the
            admin_token (at the very bottom of the file).</para>
        <para>Restart the glance service after changing the database
            connection in the glance-registry.conf and
            glance-scrubber.conf. </para>
      <literallayout class="monospaced">sudo restart glance-registry
sudo restart glance-api</literallayout>
    <!--<para>Create the tables in your backend data
        store:</para>
    <literallayout class="monospaced">sudo glance-manage db_sync</literallayout>-->
    <para>Now you can load your initial image and spin up your first
        VM if you want to use the EC2 API and euca- or nova-client
        commands. For Dashboard integration, you need to install the
        OpenStack Identity service, Keystone. </para></section>   
    
    
</section>